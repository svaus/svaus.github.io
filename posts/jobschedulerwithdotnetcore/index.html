<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Job scheduler with dotnet core" />
<meta property="og:description" content="This is sample job scheduler with Topshelf, Autofac, Quartz, log4Net. Currently using DotNet Core 2.0 version
This repository implemetns a simple console application with following libraries
 Topshelf : For creating service Autofac : For dependency injection Quartz : For scheduling job, also uses xml based job configuration log4net : For logging  Installation Build the solution in release mode and copy to server directory. Open command prompt in the directory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://svaus.github.io/posts/jobschedulerwithdotnetcore/" />
<meta property="article:published_time" content="2020-05-10T15:54:26+10:00" />
<meta property="article:modified_time" content="2020-05-10T15:54:26+10:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Job scheduler with dotnet core"/>
<meta name="twitter:description" content="This is sample job scheduler with Topshelf, Autofac, Quartz, log4Net. Currently using DotNet Core 2.0 version
This repository implemetns a simple console application with following libraries
 Topshelf : For creating service Autofac : For dependency injection Quartz : For scheduling job, also uses xml based job configuration log4net : For logging  Installation Build the solution in release mode and copy to server directory. Open command prompt in the directory."/>


    <meta name="description" content="">
    <link rel="canonical" href="https://svaus.github.io/posts/jobschedulerwithdotnetcore/">

    
    <title>Job scheduler with dotnet core &middot; Go Code</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://svaus.github.io/css/style.css" rel="stylesheet">

    

    

    
  </head>
  <body>
    
      



<nav class="white" role="navigation">
    <div class="row max-width">
        <div class="col s12 l10 offset-l1">
            
            <a href="#" data-target="nav-mobile" class="sidenav-trigger black-text">
                <i class="material-icons">menu</i>
            </a>

            
            <ul id="nav-mobile" class="sidenav">
                
                
    
    

            </ul>

            
            <a href="/" class="brand-logo grey-text text-darken-3">Go Code</a>

            
            <div class="nav-wrapper">

                
                <ul class="right hide-on-med-and-down">
                    
                    
    
    

                </ul>

            </div>
        </div>
    </div>
</nav>
    

    

<article class="max-width">
    
    <section class="row">
        <div class="col s12 m10 offset-m1 l10 offset-l1">
            <h1>Job scheduler with dotnet core</h1>
        </div>
    </section>

    
    

    
    <section class="row">
        <div class="col s12 m8 offset-m2 l2 offset-l1">
            

<p class="article-meta">
    <div class="article-meta-container">
        <div class="article-meta-author-name"></div>
        <div class="article-meta-description"></div>
    </div>
    <span class="article-meta-published-at grey-text text-darken-1">May 10, 2020</span>
</p>
        </div>
        <div class="col s12 m8 offset-m2 l6">
            <p>This is sample job scheduler with Topshelf, Autofac, Quartz, log4Net. Currently using DotNet Core 2.0 version</p>
<p>This repository implemetns a simple console application with following libraries</p>
<ol>
<li>Topshelf : For creating service</li>
<li>Autofac : For dependency injection</li>
<li>Quartz : For scheduling job, also uses xml based job configuration</li>
<li>log4net : For logging</li>
</ol>
<h1 id="installation">Installation</h1>
<p>Build the solution in release mode and copy to server directory. Open command prompt in the directory.</p>
<p>Run below command :</p>
<p><code>SampleJobSchedulerWithDotNetCore.exe install -username “DOMAIN\Service Account” -password “Its A Secret” -servicename “SampleJobSchedulerWithDotNetCore” –autostart</code></p>
<h1 id="repo">Repo</h1>
<p>You can find the repository here :</p>
<p><a href="https://github.com/svaus/SampleJobSchedulerWithDotNetCore">https://github.com/svaus/SampleJobSchedulerWithDotNetCore</a></p>
<p>Create a dotnet core project. Add below packages by modifying csproj file or nuget package manager.</p>
<pre><code>&lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Autofac&quot; Version=&quot;4.9.1&quot; /&gt;
    &lt;PackageReference Include=&quot;Autofac.Extras.Quartz&quot; Version=&quot;4.4.0&quot; /&gt;
    &lt;PackageReference Include=&quot;log4net&quot; Version=&quot;2.0.8&quot; /&gt;
    &lt;PackageReference Include=&quot;Quartz&quot; Version=&quot;3.0.7&quot; /&gt;
    &lt;PackageReference Include=&quot;Quartz.Jobs&quot; Version=&quot;3.0.7&quot; /&gt;
    &lt;PackageReference Include=&quot;Quartz.Plugins&quot; Version=&quot;3.0.7&quot; /&gt;
    &lt;PackageReference Include=&quot;Topshelf&quot; Version=&quot;4.2.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Topshelf.Autofac&quot; Version=&quot;4.0.1&quot; /&gt;
    &lt;PackageReference Include=&quot;Topshelf.Log4Net&quot; Version=&quot;4.2.0&quot; /&gt;
    &lt;PackageReference Include=&quot;Topshelf.Quartz&quot; Version=&quot;0.4.0.1&quot; /&gt;
  &lt;/ItemGroup&gt;
</code></pre><p>Modify Program.cs file and add below code. This code is doing following</p>
<ol>
<li>Adding Log4Net for logging to file</li>
<li>Adding DI</li>
<li>Initializing a HostFactory which sets windows service properties</li>
<li>Configure Log4Net with Topself</li>
</ol>
<pre><code>namespace SampleJobSchedulerWithDotNetCore
{
    class Program
    {
        static void Main(string[] args)
        {
            var logRepository = LogManager.GetRepository(Assembly.GetEntryAssembly());
            XmlConfigurator.Configure(logRepository, new FileInfo(&quot;log4net.config&quot;));

            IContainer container = DependencyInjection.Build();


            HostFactory.Run(hostConfigurator =&gt;
            {
                // Set windows service properties
                hostConfigurator.SetServiceName(&quot;SampleSchedulerService&quot;);
                hostConfigurator.SetDisplayName(&quot;Sample Service&quot;);
                hostConfigurator.SetDescription(&quot;Executes Job.&quot;);

                hostConfigurator.RunAsLocalSystem();
                // Configure Log4Net with Topself
                hostConfigurator.UseLog4Net();
                hostConfigurator.UseAutofacContainer(container);
                hostConfigurator.Service&lt;SchedulerService&gt;(serviceConfigurator =&gt;
                {
                    serviceConfigurator.ConstructUsing(hostSettings =&gt; container.Resolve&lt;SchedulerService&gt;());
                    serviceConfigurator.WhenStarted(s =&gt; s.Start());
                    serviceConfigurator.WhenStopped(s =&gt; s.Shutdown());
                });
            });
        }
    }
}

</code></pre><p>It is very simple to create a job scheduler with dotnet core Hostfactory. On compilation this will generate an exe file which can just be added as windows service.</p>

        </div>
    </section>
</article>



    
      <footer class="page-footer grey lighten-5">
    <div class="row max-width">
        <div class="col s12 l10 offset-l1 clear-padding">
            <div class="row">
    
        
    

    
    
    <div class="col s12 l12">
        <h5 class="black-text">Have fun with coding</h5>
<p class="grey-text text-darken-4">Look for posts on dotnet, azure, devops blogs.</p>
    </div>

    
</div>


        </div>
    </div>
    <div class="footer-copyright">
        <div class="row max-width" style="width: 100%;">
            <div class="col s12 l10 offset-l1">
                <span class="grey-text text-darken-4">© 2020.</span>
<div class="right">
    
</div>
            </div>
        </div>
    </div>
</footer>
    

    
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://svaus.github.io/js/script.js"></script>
  </body>
</html>